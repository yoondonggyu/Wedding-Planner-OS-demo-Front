<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Wedding OS - Database ERD</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ 
      startOnLoad: true,
      theme: 'dark',
      themeVariables: {
        primaryColor: '#8b5cf6',
        primaryTextColor: '#f7f8fc',
        primaryBorderColor: '#22d3ee',
        lineColor: '#9da6bf',
        secondaryColor: '#10121a',
        tertiaryColor: '#181b25'
      }
    });
  </script>
  <style>
    :root {
      --bg: #05060a;
      --card: #10121a;
      --soft: #181b25;
      --text: #f7f8fc;
      --muted: #9da6bf;
      --line: rgba(255,255,255,0.08);
      --accent: #8b5cf6;
      --accent-2: #22d3ee;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Pretendard', system-ui, -apple-system, sans-serif;
      background: radial-gradient(circle at top, rgba(34,211,238,0.15), transparent 40%),
                  radial-gradient(circle at 30% 10%, rgba(139,92,246,0.2), transparent 35%),
                  var(--bg);
      color: var(--text);
      line-height: 1.6;
      padding: 0;
      min-height: 100vh;
    }
    .container {
      max-width: 1600px;
      margin: 0 auto;
      padding: 32px 24px;
    }
    header {
      text-align: center;
      padding: 48px 0 32px;
      border-bottom: 1px solid var(--line);
      margin-bottom: 48px;
    }
    header h1 {
      font-size: clamp(32px, 4vw, 46px);
      margin-bottom: 16px;
      background: linear-gradient(135deg, var(--accent-2), var(--accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    header p {
      color: var(--muted);
      max-width: 640px;
      margin: 0 auto;
    }
    .update-info {
      background: rgba(34,211,238,0.1);
      border: 1px solid rgba(34,211,238,0.3);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 32px;
    }
    .update-info h3 {
      color: var(--accent-2);
      margin-bottom: 12px;
    }
    .update-info ul {
      margin-left: 24px;
      color: var(--muted);
    }
    .update-info li {
      margin: 8px 0;
    }
    .mermaid {
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 32px;
      overflow-x: auto;
    }
    .section-title {
      font-size: 24px;
      font-weight: 600;
      margin: 48px 0 24px;
      color: var(--accent-2);
      padding-bottom: 12px;
      border-bottom: 2px solid var(--line);
    }
    @media (max-width: 768px) {
      .container { padding: 16px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>ğŸ—„ï¸ Wedding OS Database ERD</h1>
      <p>ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡° ë° í…Œì´ë¸” ê´€ê³„ ë‹¤ì´ì–´ê·¸ë¨</p>
    </header>

    <div class="update-info">
      <h3>ğŸ“‹ ìµœê·¼ ì—…ë°ì´íŠ¸ (2025ë…„)</h3>
      <ul>
        <li><strong>posts í…Œì´ë¸”:</strong> <code>category VARCHAR(50)</code> ì»¬ëŸ¼ ì¶”ê°€ (ì¹´í…Œê³ ë¦¬ í•„í„°ë§ ì§€ì›)</li>
        <li><strong>posts í…Œì´ë¸”:</strong> <code>vendor_id BIGINT</code> ì»¬ëŸ¼ ì¶”ê°€ (ì—…ì²´ ì—°ê²°, ì™¸ë˜í‚¤: vendors.id)</li>
        <li><strong>ì¸ë±ìŠ¤ ì¶”ê°€:</strong> <code>idx_posts_category</code>, <code>idx_posts_board_type_category</code></li>
      </ul>
    </div>

    <h2 class="section-title">í•µì‹¬ í…Œì´ë¸” ê´€ê³„ë„</h2>
    <div class="mermaid">
erDiagram
    users ||--o{ posts : "ì‘ì„±"
    users ||--o| couples : "ì—°ê²°"
    couples ||--o{ posts : "ê³µìœ "
    couples ||--o{ calendar_events : "ê³µìœ "
    couples ||--o{ budget_items : "ê³µìœ "
    users ||--o{ calendar_events : "ìƒì„±"
    users ||--o{ budget_items : "ìƒì„±"
    users ||--o{ comments : "ì‘ì„±"
    users ||--o{ post_likes : "ì¢‹ì•„ìš”"
    users ||--o{ favorite_vendors : "ì¦ê²¨ì°¾ê¸°"
    users ||--o{ wedding_profiles : "í”„ë¡œí•„"
    users ||--o{ chat_history : "ëŒ€í™”"
    users ||--o{ chat_memories : "ë©”ëª¨ë¦¬"
    users ||--o{ vendor_threads : "ìŠ¤ë ˆë“œ"
    
    posts ||--o{ comments : "ëŒ“ê¸€"
    posts ||--o{ post_likes : "ì¢‹ì•„ìš”"
    posts }o--o| vendors : "ì—…ì²´ ì—°ê²°"
    posts }o--o{ tags : "íƒœê·¸"
    
    vendors ||--o{ favorite_vendors : "ì¦ê²¨ì°¾ê¸°"
    vendors ||--o{ vendor_threads : "ìŠ¤ë ˆë“œ"
    vendors ||--o{ vendor_messages : "ë©”ì‹œì§€"
    vendors ||--o{ vendor_contracts : "ê³„ì•½"
    vendors ||--o{ vendor_payment_schedules : "ê²°ì œì¼ì •"
    
    wedding_profiles ||--o{ favorite_vendors : "í”„ë¡œí•„"
    wedding_profiles ||--o{ vendors : "ì¶”ì²œ"
    
    vendor_threads ||--o{ vendor_messages : "ë©”ì‹œì§€"
    vendor_threads ||--o{ vendor_contracts : "ê³„ì•½"
    vendor_threads ||--o{ vendor_payment_schedules : "ê²°ì œì¼ì •"
    </div>

    <h2 class="section-title">ì£¼ìš” í…Œì´ë¸” ìƒì„¸ êµ¬ì¡°</h2>
    
    <h3 style="color: var(--accent-2); margin: 32px 0 16px;">ğŸ“ posts (ê²Œì‹œê¸€)</h3>
    <div class="mermaid">
erDiagram
    posts {
      BIGINT id PK
      BIGINT user_id FK
      BIGINT couple_id FK "NULL, ì»¤í”Œ ê³µìœ "
      BIGINT vendor_id FK "NULL, ì—…ì²´ ì—°ê²°"
      VARCHAR title
      TEXT content
      TEXT image_url "NULL"
      VARCHAR board_type "ê¸°ë³¸ê°’: couple"
      VARCHAR category "NULL, ì¹´í…Œê³ ë¦¬ í•„í„°ë§"
      TEXT summary "NULL, AI ìš”ì•½"
      FLOAT sentiment_score "NULL"
      VARCHAR sentiment_label "NULL"
      INT view_count "ê¸°ë³¸ê°’: 0"
      DATETIME created_at
      DATETIME updated_at
    }
    </div>

    <h3 style="color: var(--accent-2); margin: 32px 0 16px;">ğŸ‘¥ users (ì‚¬ìš©ì)</h3>
    <div class="mermaid">
erDiagram
    users {
      BIGINT id PK
      VARCHAR email UK
      VARCHAR password
      VARCHAR nickname
      TEXT profile_image_url "NULL"
      ENUM role "ê¸°ë³¸ê°’: USER"
      ENUM gender "NULL"
      VARCHAR couple_key UK "NULL"
      VARCHAR partner_couple_key "NULL"
      BIGINT couple_id FK "NULL"
      ENUM vendor_approval_status "NULL"
      ENUM admin_approval_status "NULL"
      DATETIME created_at
      DATETIME updated_at
    }
    </div>

    <h3 style="color: var(--accent-2); margin: 32px 0 16px;">ğŸ’‘ couples (ì»¤í”Œ)</h3>
    <div class="mermaid">
erDiagram
    couples {
      BIGINT id PK
      VARCHAR couple_key UK
      BIGINT user1_id
      BIGINT user2_id "NULL"
      VARCHAR user1_entered_key "NULL"
      VARCHAR user2_entered_key "NULL"
      ENUM status "ê¸°ë³¸ê°’: PENDING"
      DATETIME connected_at "NULL"
      DATETIME created_at
      DATETIME updated_at
    }
    </div>

    <h3 style="color: var(--accent-2); margin: 32px 0 16px;">ğŸ¢ vendors (ì—…ì²´)</h3>
    <div class="mermaid">
erDiagram
    vendors {
      BIGINT id PK
      BIGINT user_id FK "ì—…ì²´ ê³„ì •"
      VARCHAR name
      TEXT description "NULL"
      ENUM vendor_type
      VARCHAR base_location_city "NULL"
      VARCHAR base_location_district "NULL"
      DECIMAL min_price "NULL"
      DECIMAL max_price "NULL"
      ENUM guest_count_category
      JSON metadata "NULL"
      DATETIME created_at
      DATETIME updated_at
    }
    </div>

    <h3 style="color: var(--accent-2); margin: 32px 0 16px;">ğŸ“… calendar_events (ìº˜ë¦°ë” ì¼ì •)</h3>
    <div class="mermaid">
erDiagram
    calendar_events {
      BIGINT id PK
      BIGINT user_id FK
      BIGINT couple_id FK "NULL, ì»¤í”Œ ê³µìœ "
      VARCHAR title
      TEXT description "NULL"
      DATE start_date "NULL"
      DATE end_date "NULL"
      TIME start_time "NULL"
      TIME end_time "NULL"
      VARCHAR location "NULL"
      VARCHAR category "NULL"
      ENUM priority "NULL"
      ENUM assignee "NULL"
      INT progress "NULL"
      BOOLEAN is_completed "NULL"
      DATETIME created_at "NULL"
      DATETIME updated_at "NULL"
    }
    </div>

    <h3 style="color: var(--accent-2); margin: 32px 0 16px;">ğŸ’° budget_items (ì˜ˆì‚° í•­ëª©)</h3>
    <div class="mermaid">
erDiagram
    budget_items {
      BIGINT id PK
      BIGINT user_id FK
      BIGINT couple_id FK "NULL, ì»¤í”Œ ê³µìœ "
      VARCHAR item_name
      VARCHAR category "ê¸°ë³¸ê°’: etc"
      DECIMAL estimated_budget
      DECIMAL actual_expense "ê¸°ë³¸ê°’: 0.0"
      VARCHAR unit "NULL"
      DECIMAL quantity "ê¸°ë³¸ê°’: 1.0"
      TEXT notes "NULL"
      ENUM payer "ê¸°ë³¸ê°’: both"
      DATETIME created_at
      DATETIME updated_at
    }
    </div>

    <h3 style="color: var(--accent-2); margin: 32px 0 16px;">ğŸ’¬ vendor_threads (ì—…ì²´ ìŠ¤ë ˆë“œ)</h3>
    <div class="mermaid">
erDiagram
    vendor_threads {
      BIGINT id PK
      BIGINT user_id FK
      BIGINT vendor_id FK
      ENUM thread_type "ê¸°ë³¸ê°’: one_on_one"
      DATETIME created_at
      DATETIME updated_at
    }
    </div>

    <h3 style="color: var(--accent-2); margin: 32px 0 16px;">ğŸ“¨ vendor_messages (ì—…ì²´ ë©”ì‹œì§€)</h3>
    <div class="mermaid">
erDiagram
    vendor_messages {
      BIGINT id PK
      BIGINT thread_id FK
      BIGINT vendor_id FK
      ENUM sender_type
      TEXT message
      BOOLEAN is_read "ê¸°ë³¸ê°’: false"
      DATETIME created_at
    }
    </div>

    <h2 class="section-title">ì¸ë±ìŠ¤ ì •ë³´</h2>
    <div style="background: var(--card); border: 1px solid var(--line); border-radius: 12px; padding: 24px; margin-bottom: 32px;">
      <h3 style="color: var(--accent-2); margin-bottom: 16px;">posts í…Œì´ë¸” ì¸ë±ìŠ¤</h3>
      <ul style="color: var(--muted); margin-left: 24px; line-height: 2;">
        <li><code>PRIMARY KEY (id)</code></li>
        <li><code>INDEX idx_posts_user_id (user_id)</code></li>
        <li><code>INDEX idx_posts_couple_id (couple_id)</code></li>
        <li><code>INDEX idx_posts_vendor_id (vendor_id)</code> - ì—…ì²´ ì—°ê²°</li>
        <li><code>INDEX idx_posts_category (category)</code> - ì¹´í…Œê³ ë¦¬ í•„í„°ë§</li>
        <li><code>INDEX idx_posts_board_type_category (board_type, category)</code> - ë³µí•© ì¸ë±ìŠ¤</li>
        <li><code>FOREIGN KEY (user_id) REFERENCES users(id)</code></li>
        <li><code>FOREIGN KEY (couple_id) REFERENCES couples(id)</code></li>
        <li><code>FOREIGN KEY (vendor_id) REFERENCES vendors(id)</code> - ON DELETE SET NULL</li>
      </ul>
    </div>

    <h2 class="section-title">ì¹´í…Œê³ ë¦¬ ì‹œìŠ¤í…œ</h2>
    <div style="background: var(--card); border: 1px solid var(--line); border-radius: 12px; padding: 24px; margin-bottom: 32px;">
      <p style="color: var(--muted); margin-bottom: 16px;">
        <code>posts.category</code> í•„ë“œëŠ” 35ê°œì˜ ì›¨ë”© ê´€ë ¨ ì¹´í…Œê³ ë¦¬ë¥¼ ì§€ì›í•©ë‹ˆë‹¤:
      </p>
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px; margin-top: 16px;">
        <div>
          <strong style="color: var(--accent-2);">ì‚¬ì§„/ì˜ìƒ (4ê°œ)</strong>
          <ul style="color: var(--muted); margin-top: 8px; margin-left: 20px; font-size: 14px;">
            <li>ì•„ì´í°_ìŠ¤ëƒ…</li>
            <li>ì›¨ë”©_ìŠ¤íŠœë””ì˜¤</li>
            <li>ì›¨ë”©_ì‚¬ì§„</li>
            <li>ì›¨ë”©_ì˜ìƒ</li>
          </ul>
        </div>
        <div>
          <strong style="color: var(--accent-2);">ì‹ì¥ (4ê°œ)</strong>
          <ul style="color: var(--muted); margin-top: 8px; margin-left: 20px; font-size: 14px;">
            <li>ì›¨ë”©í™€</li>
            <li>ì‹¤ë‚´_ì‹ì¥</li>
            <li>ì•¼ì™¸_ì‹ì¥</li>
            <li>ë³µí•©_ì‹ì¥</li>
          </ul>
        </div>
        <div>
          <strong style="color: var(--accent-2);">í”Œë˜ë„ˆ (2ê°œ)</strong>
          <ul style="color: var(--muted); margin-top: 8px; margin-left: 20px; font-size: 14px;">
            <li>ì›¨ë”©_í”Œë˜ë„ˆ</li>
            <li>ì›¨ë”©_ì½”ë””ë„¤ì´í„°</li>
          </ul>
        </div>
        <div>
          <strong style="color: var(--accent-2);">ì˜ìƒ (5ê°œ)</strong>
          <ul style="color: var(--muted); margin-top: 8px; margin-left: 20px; font-size: 14px;">
            <li>ë“œë ˆìŠ¤ìƒµ</li>
            <li>í„±ì‹œë„ìƒµ</li>
            <li>ë©”ì´í¬ì—…_í—¤ì–´</li>
            <li>ë·°í‹°_ì‚´ë¡±</li>
            <li>í•œë³µ</li>
          </ul>
        </div>
        <div>
          <strong style="color: var(--accent-2);">ì‹ìŒë£Œ (4ê°œ)</strong>
          <ul style="color: var(--muted); margin-top: 8px; margin-left: 20px; font-size: 14px;">
            <li>ì¼€ì´í„°ë§</li>
            <li>ë·”í˜_ì‹ë‹¹</li>
            <li>ì¼€ì´í¬_ë””ì €íŠ¸</li>
            <li>ë°”_ìŒë£Œ</li>
          </ul>
        </div>
        <div>
          <strong style="color: var(--accent-2);">ê½ƒ/ì¥ì‹ (3ê°œ)</strong>
          <ul style="color: var(--muted); margin-top: 8px; margin-left: 20px; font-size: 14px;">
            <li>ê½ƒ_í”Œë¡œë¦¬ìŠ¤íŠ¸</li>
            <li>ì¥ì‹_ë°ì½”</li>
            <li>ë¶€ì¼€_ê½ƒë‹¤ë°œ</li>
          </ul>
        </div>
        <div>
          <strong style="color: var(--accent-2);">ì£¼ì–¼ë¦¬ (2ê°œ)</strong>
          <ul style="color: var(--muted); margin-top: 8px; margin-left: 20px; font-size: 14px;">
            <li>ì˜ˆë¬¼_ì£¼ì–¼ë¦¬</li>
            <li>ì˜ˆë¬¼_ë°˜ì§€</li>
          </ul>
        </div>
        <div>
          <strong style="color: var(--accent-2);">êµí†µ (3ê°œ)</strong>
          <ul style="color: var(--muted); margin-top: 8px; margin-left: 20px; font-size: 14px;">
            <li>ì›¨ë”©ì¹´</li>
            <li>ë¦¬ë¬´ì§„</li>
            <li>êµí†µ_ìš´ì†¡</li>
          </ul>
        </div>
        <div>
          <strong style="color: var(--accent-2);">ì—°ì˜ˆ (4ê°œ)</strong>
          <ul style="color: var(--muted); margin-top: 8px; margin-left: 20px; font-size: 14px;">
            <li>ì‚¬íšŒì</li>
            <li>ì¶•ê°€</li>
            <li>ë°´ë“œ_ì—°ì£¼ì</li>
            <li>ì¶•ê°€_ì—°ì£¼</li>
          </ul>
        </div>
        <div>
          <strong style="color: var(--accent-2);">ê¸°íƒ€ (4ê°œ)</strong>
          <ul style="color: var(--muted); margin-top: 8px; margin-left: 20px; font-size: 14px;">
            <li>ì²­ì²©ì¥_ì¸ì‡„</li>
            <li>ì›¨ë”©ì„ ë¬¼_ë‹µë¡€í’ˆ</li>
            <li>í˜¸í…”_ìˆ™ë°•</li>
            <li>ì›¨ë”©ë°•ëŒíšŒ</li>
            <li>ì‹ í˜¼ì—¬í–‰</li>
          </ul>
        </div>
      </div>
    </div>

    <div style="text-align: center; padding: 32px 0; color: var(--muted); border-top: 1px solid var(--line); margin-top: 48px;">
      <p>Wedding OS Database ERD Viewer</p>
      <p style="font-size: 14px; margin-top: 8px;">ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: 2025ë…„</p>
    </div>
  </div>
</body>
</html>

